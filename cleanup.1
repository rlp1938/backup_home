.TH "cleanup" 1 "2015-01-15" "Robert L Parker rlp1938@gmail.com"


.SH NAME

.P
\fBcleanup\fR \- A program to backup the invoking user's home directory by
running \fBrsync\fR. This program functions in the same way as \fBbackup\fR
except that objects that have been deleted from the user's home dir will
be deleted from the backup set also. Nor does it have any first run
capability so \fBbackup\fR should be run manually before hand so that the
necessary config files will have been installed.

.SH SYNOPSIS

.P
\fBcleanup\fR \- requires no arguments and no options.

.SH DESCRIPTION

.P
\fBcleanup\fR \- determines the source and destination paths from
information recorded in configuration files located in
\fI$HOME/.config/backup/\fR. The destination is to be in a removable
device connected via USB or other suitable technology.

.P
NB this program is intended to be run by manually because it invokes
\fBrsync\fR using the \fI\-\-del\fR option. The logs should be reviewed before
running \fBcleanup\fR. You might want to filter the \fIdryrun.log\fR with
\fBdecruft\fR to remove the noise generated by the browser caches and
similar.

.SH FILES

.P
\fIbackup.cfg\fR names the backup device eg \fI/dev/sdb/\fR without the
partition number, and the name of the backup directory. You may use more
than one backup set, and may have them with several partitions. The
program will find the named backup dir if the device is mounted, or
record an error if not.

.P
\fIexcludes\fR is to contain a list of what you do not want to be backed
up. The items are to be listed in a way understood by \fBrsync\fR.

.P
\fIcruft\fR More than 90% of backup activity is generated by programs like
browsers writing and deleting cache and config files. This generates a
huge amount of data that may mask events that need to be seen by the
user. \fBdecruft\fR is run using a logfile as it's argument and it lists
the content of that logfile on \fIstdout\fR but it excludes those items that match regular expressions recorded in \fIcruft\fR. These regexes are
to be in \fBegrep\fR format. See \fBEXAMPLES\fR below.

.P
\fI$HOME/lock/backup.lock\fR A zero length file to guard against multiple
versions of \fBbackup\fR running. The file is removed when \fBbackup\fR
completes.

.P
\fI$HOME/log/backup.log\fR The main log file. This is written by
\fBcleanup\fR as well as \fBbackup\fR. The main difference is that you will
have lines preceded by 'deleting' in the log.

.P
\fI$HOME/log/dryrun.log\fR This file is created new at the end of every
run of \fBbackup\fR. Because lines beginning with 'deleting' will be
generated on every run there is no point in appending this file.

.P
\fI$HOME/log/errors.log\fR This file captures everything written to
\fIstderr\fR. Generally it will record events such as the backup drive
not mounted or that an instance of backup is already running.

.P
\fI$HOME/log/backup.log.0\fR .. \fIbackup.log.7\fR generated by \fBbulogrot\fR. \fIbackup.log.7\fR is discarded on each run of \fBbulogrot\fR.

.P
\fI$HOME/log/errors.log.0\fR .. \fIerrors.log.7\fR generated by \fBbulogrot\fR
\&. \fIerrors.log.7\fR is discarded on each run of \fBbulogrot\fR.

.SH EXAMPLES

.P
decruft ~/log/dryrun.log |grep '^deleting' |less

.P
decruft ~/log/backup.log |less

.P
cleanup

.P
backup

.P
bulogrot

.SH SEE ALSO

.P
\fBbackup\fR (1), \fBbulogrot\fR (1), \fBdecruft\fR (1)

.\" man code generated by txt2tags 2.6 (http://txt2tags.org)
.\" cmdline: txt2tags -t man cleanup.t2t
